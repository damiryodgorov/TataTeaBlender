<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>FTI Touch Display</title>
    <!-- Not present in the tutorial. Just for basic styling. -->
   
    <link rel="stylesheet" href="css/base.css" />
    <link rel="stylesheet" href="css/app.css" />

    <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.14.0/react.min.js"></script>-->
   <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.6.15/browser.min.js"></script>-->
  <!--  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/1.0.2/Chart.min.js"></script>
    <script src="scripts/Chart.Scatter.min.js"></script>-->
   <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>-->
    <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/marked/0.3.2/marked.min.js"></script>-->
   <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.7/socket.io.min.js"></script>-->

    <script src="node_modules/babel-core/browser.min.js"></script>
     <script src="scripts/smoothie.js"></script>
  <script src="scripts/react.min.js"></script>
    <!--<script src="node_modules/react/dist/react.js"></script>-->
     <script src="node_modules/react-dom/dist/react-dom.min.js"></script>
    <script src="node_modules/react-data-grid/dist/react-data-grid.min.js"></script>
    <script src="scripts/react-sortable-hoc.min.js"></script>
    <scripts src="scripts/react-modal.min.js"></scripts>
    <script src="node_modules/socket.io/node_modules/socket.io-client/socket.io.js"></script>
  </head>
  <body>
    <div id="content"></div>
    <script>

var vdefList ={};
var Vdef;
var pVdef;
var isVdefSet = false;
var nVdf;
var value_groups = {
  "Calibration"  : ["AutoPhasePacks", "CalibrateMode", "PhaseTrigLimit", "PhaseTrigThres","PhaseLimitDry","PhaseLimitDrySpread",
                  "PhaseAngle", "PhaseLimitWet","PhaseLimitWetSpread","MPhaseOrder","MPhaseDD","MPhaseRD","PhaseSpeed",
                  "OscPower","PhaseMode","PhaseModeHold","AutoLearn"],
  "Faults"       : ["FaultStore","Mask", "FaultLatch", "FaultRejMode", "FlashRejCount", "Rej2Fault", "TOGGLE_REJ_MODE","FaultClearTime"], 
  "Output"       : ["BannerBuzzMode", "BannerMode", "BannerRejMode","IOBoardType","LightStackMode"],
  "Password"     : ["PassAccCal", "PassAccClrFaults", "PassAccClrLatch", "PassAccClrRej", "PassAccProd", "PassAccSelUnit", 
                      "PassAccSens", "PassAccTest", "PassOn", "PW1", "PW2", "PW3", "PW4","PassAccTime","PassAccSync"],
  "Rej Setup"    : ["AppUnitDist", "BeltSpeed",  "EyeBlockTime", "EyeDetSwipe", "EyeDist", "EyeMinGapDist", "EyePkgLength", 
                      "EyeReject", "HeadCoilSp", "HeadDepth", "Rej2Check", "Rej2Latch", "RejBinDoorTime", "RejCheckMode",
                      "RejCheckTime", "RejDelClock", "RejDelSec", "RejDelSec2", "RejDurSec", "RejDurSec2", "RejExitDist",
                        "RejExitWin", "RejLatchMode", "RejMode", "RejOnProdHi", "RejTravDel", "RejTravDur", "SplitPkgLength",
                        "PowerupRej","ExcessRejects","ExcessRejTime"],
  "Sensitivity" : ["PeakMode","Sens","BigMetThres","DetMode","ThresX","ThresR","DetThresh","ThresProdHi","FilterNoise","DcCoeffNorm"],
  "Test"        : ["HaloBoard","HaloPeakRFe", "HaloPeakRNFe", "HaloPeakRSs", "HaloPeakXFe", "HaloPeakXNFe", "HaloPeakXSs", 
                    "IBTestPassesFe", "IBTestPassesNFe", "IBTestPassesSS", "TestMode", "TestTime","TestDeferTime"],
  "Input"       : ["CIPCycleTime","CIPDwellTime"]                      
}  
      function load_vdef_parameters(json) {
  // body...
  if (vdefList[json['@version']]){
    console.log('already have this version')

  }else{
      Vdef = json;
  console.log(json)
  var res = [];
    res[0] = [];
    res[1] = [];
    res[2] = [];
    res[3] = [];
    nVdf = {};
    nVdf['Other'] = [];
    nVdf['Password'] = [];
    nVdf['Rej Setup'] = [];
    nVdf['Faults'] = [];
    nVdf['Output'] = [];
    nVdf['Sensitivity'] = [];
    nVdf['Test'] = [];
    nVdf['Calibration'] = [];

    json["@params"].forEach(function(p ){
      res[p["@rec"]][p["@name"]] = p;
     var nm = p['@name'];
     var otherFlag = true;
     for(var o in value_groups){
     // console.log(o)
     if(o == 'Faults'){
      if(nm.indexOf('FaultMask')!=1){
        nVdf[o].push(p);
        otherFlag = false;
        break;
      }
     }else if(o == 'Test'){
      if(nm.indexOf('TestConfig')!= -1){
        nVdf[o].push(p);
        otherFlag = false;
        break;
      }
     }
     if(value_groups[o].indexOf(nm) != -1){
      nVdf[o].push(p);
      otherFlag = false;
      break;
     }
   }
   if(otherFlag){  
      nVdf['Other'].push(p)
   }
    });
    console.log(nVdf)
    res[2] = json["@deps"];
    res[3] = json["@labels"]
    pVdef = res;
    vdefList[json['@version']] = [json, res, nVdf]
    isVdefSet = true;
    

  }

  //isVdefSet = true;
}
    </script>
    <script type="text/babel" src="scripts/components.js"></script>
    <script type="text/babel" src="scripts/app.js"></script>
     </body>
</html>
